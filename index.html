<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>استبيان العميل الفاخر</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=El+Messiri:wght@400;500;600;700&display=swap');
body{background:#1a1208;color:#f8e9c4;font-family:'El Messiri',sans-serif;display:flex;justify-content:center;align-items:center;min-height:100vh;padding:15px}
.container{max-width:700px;width:100%;background:rgba(255,255,255,0.05);border:1px solid rgba(212,175,55,0.3);border-radius:20px;padding:25px}
.title{text-align:center;color:#d4af37;margin-bottom:10px}
.subtitle{text-align:center;color:#f5e9c2;margin-bottom:25px}
.question-title{color:#f1c75e;margin-bottom:10px}
.text-input{width:100%;padding:10px;border:1px solid rgba(212,175,55,0.3);border-radius:10px;background:rgba(255,255,255,0.05);color:#f8e9c4;margin-bottom:10px}
.option-card{border:1px solid rgba(212,175,55,0.3);border-radius:10px;padding:10px;margin-bottom:10px;cursor:pointer}
.option-card.selected{border-color:#d4af37;background:rgba(212,175,55,0.1)}
.nav-btn{padding:10px 20px;background:linear-gradient(45deg,#b8860b,#d4af37);border:none;border-radius:10px;color:#1a1208;cursor:pointer;margin:5px;font-weight:bold}
.error-message{color:#ff6b6b;font-size:0.85rem;display:none;margin-bottom:10px}
#thankyou-message{text-align:center;display:none}
#loading{text-align:center;display:none}
</style>
</head>
<body>
<div class="container">
<h1 class="title">استبيان العميل الفاخر</h1>
<p class="subtitle">يرجى تعبئة جميع البيانات بدقة</p>

<form id="clientForm">

<!-- 1 -->
<div class="form-step active" id="step-1">
<h2 class="question-title">1️⃣ اسم الورشة أو المشروع</h2>
<input type="text" class="text-input" name="project_name" placeholder="أدخل اسم الورشة أو المشروع">
<div class="error-message" id="error-1"></div>
</div>

<!-- 2 -->
<div class="form-step" id="step-2">
<h2 class="question-title">2️⃣ نوع الشغل الأساسي</h2>
<label class="option-card"><input type="radio" name="work_type" value="دهان"> دهان</label>
<label class="option-card"><input type="radio" name="work_type" value="تذهيب"> تذهيب</label>
<label class="option-card"><input type="radio" name="work_type" value="تشطيب"> تشطيب</label>
<label class="option-card"><input type="radio" name="work_type" value="شيء آخر"> شيء آخر</label>
<div class="custom-input" id="work-custom"><input type="text" class="text-input" name="work_custom" placeholder="أدخل نوع الشغل الآخر"></div>
<div class="error-message" id="error-2"></div>
</div>

<!-- 3 -->
<div class="form-step" id="step-3">
<h2 class="question-title">3️⃣ شكل الشعار المفضل</h2>
<label class="option-card"><input type="radio" name="logo_style" value="فخم وكلاسيكي"> فخم وكلاسيكي</label>
<label class="option-card"><input type="radio" name="logo_style" value="بسيط وحديث"> بسيط وحديث</label>
<label class="option-card"><input type="radio" name="logo_style" value="مزيج من الإثنين"> مزيج من الإثنين</label>
<div class="error-message" id="error-3"></div>
</div>

<!-- 4 -->
<div class="form-step" id="step-4">
<h2 class="question-title">4️⃣ الألوان المفضلة</h2>
<label class="option-card"><input type="radio" name="colors" value="ذهبي وكلاسيكي"> ذهبي وكلاسيكي</label>
<label class="option-card"><input type="radio" name="colors" value="ألوان ترابية"> ألوان ترابية</label>
<label class="option-card"><input type="radio" name="colors" value="ألوان زاهية"> ألوان زاهية</label>
<label class="option-card"><input type="radio" name="colors" value="شيء آخر"> شيء آخر</label>
<div class="custom-input" id="color-custom"><input type="text" class="text-input" name="color_custom" placeholder="أدخل الألوان الأخرى"></div>
<div class="error-message" id="error-4"></div>
</div>

<!-- 5 -->
<div class="form-step" id="step-5">
<h2 class="question-title">5️⃣ نوع الشعار</h2>
<label class="option-card"><input type="radio" name="logo_type" value="رمز فقط"> رمز فقط</label>
<label class="option-card"><input type="radio" name="logo_type" value="كتابة فقط"> كتابة فقط</label>
<label class="option-card"><input type="radio" name="logo_type" value="رمز وكتابة"> رمز وكتابة</label>
<label class="option-card"><input type="radio" name="logo_type" value="شيء آخر"> شيء آخر</label>
<div class="custom-input" id="logo-type-custom"><input type="text" class="text-input" name="logo_type_custom" placeholder="أدخل نوع الشعار الآخر"></div>
<div class="error-message" id="error-5"></div>
</div>

<!-- 6 -->
<div class="form-step" id="step-6">
<h2 class="question-title">6️⃣ الإحساس المطلوب</h2>
<label class="option-card"><input type="radio" name="feeling" value="فخامة"> فخامة</label>
<label class="option-card"><input type="radio" name="feeling" value="احتراف"> احتراف</label>
<label class="option-card"><input type="radio" name="feeling" value="ذوق"> ذوق</label>
<label class="option-card"><input type="radio" name="feeling" value="شيء آخر"> شيء آخر</label>
<div class="custom-input" id="feeling-custom"><input type="text" class="text-input" name="feeling_custom" placeholder="أدخل الإحساس الآخر"></div>
<div class="error-message" id="error-6"></div>
</div>

<!-- 7 -->
<div class="form-step" id="step-7">
<h2 class="question-title">7️⃣ هل لديك لوجو قديم؟</h2>
<label class="option-card"><input type="radio" name="old_logo" value="نعم"> نعم</label>
<label class="option-card"><input type="radio" name="old_logo" value="لا"> لا</label>
<div id="logo-details" style="display:none;margin-top:15px;">
<textarea class="text-input" name="logo_details" rows="3" placeholder="صف اللوجو القديم إن وجد..."></textarea>
<input type="file" id="file-input" style="display:none;" accept="image/*,.pdf,.psd,.ai">
<div class="option-card" id="file-upload">📁 انقر لرفع ملفات اللوجو القديم <p class="file-name" id="file-name">لم يتم رفع أي ملف بعد</p></div>
</div>
<div class="error-message" id="error-7"></div>
</div>

<div style="display:flex;justify-content:space-between;margin-top:20px;">
<button type="button" class="nav-btn" id="prev-btn" disabled>السابق</button>
<button type="button" class="nav-btn" id="next-btn">التالي</button>
<button type="submit" class="nav-btn" id="submit-btn" style="display:none;">إرسال</button>
</div>
</form>

<div id="loading"><p>جاري الإرسال...</p></div>
<div id="thankyou-message"><h2>✅ تم استلام استبيانك بنجاح</h2></div>
</div>

<script>
const totalSteps=7;let currentStep=1;
const scriptURL="https://script.google.com/macros/s/AKfycbyrbeM-XjltWIR7T9qQGcbv3L1jTDiOWRWofzRi9Cm2ojrvYPWw0PPcC3YLv5D6smad/exec";

function updateUI(){
document.querySelectorAll('.form-step').forEach(e=>e.classList.remove('active'));
document.getElementById(`step-${currentStep}`).classList.add('active');
document.getElementById('prev-btn').disabled=currentStep===1;
document.getElementById('next-btn').style.display=currentStep===totalSteps?'none':'inline-block';
document.getElementById('submit-btn').style.display=currentStep===totalSteps?'inline-block':'none';
window.scrollTo({top:0,behavior:'smooth'});
}

function validateStep(s){
const show=(id,msg)=>{const e=document.getElementById(`error-${id}`);e.textContent=msg;e.style.display='block';};
document.querySelectorAll('.error-message').forEach(e=>e.style.display='none');
switch(s){
case 1:if(!document.querySelector('input[name="project_name"]').value.trim()){show(1,"يرجى إدخال اسم المشروع");return false;}return true;
case 2:const w=document.querySelector('input[name="work_type"]:checked');if(!w){show(2,"يرجى اختيار نوع الشغل");return false;}if(w.value==="شيء آخر"&&!document.querySelector('input[name="work_custom"]').value.trim()){show(2,"يرجى كتابة نوع الشغل الآخر");return false;}return true;
case 3:if(!document.querySelector('input[name="logo_style"]:checked')){show(3,"يرجى اختيار شكل الشعار");return false;}return true;
case 4:const c=document.querySelector('input[name="colors"]:checked');if(!c){show(4,"يرجى اختيار الألوان");return false;}if(c.value==="شيء آخر"&&!document.querySelector('input[name="color_custom"]').value.trim()){show(4,"يرجى كتابة الألوان الأخرى");return false;}return true;
case 5:const l=document.querySelector('input[name="logo_type"]:checked');if(!l){show(5,"يرجى اختيار نوع الشعار");return false;}if(l.value==="شيء آخر"&&!document.querySelector('input[name="logo_type_custom"]').value.trim()){show(5,"يرجى كتابة نوع الشعار الآخر");return false;}return true;
case 6:const f=document.querySelector('input[name="feeling"]:checked');if(!f){show(6,"يرجى اختيار الإحساس");return false;}if(f.value==="شيء آخر"&&!document.querySelector('input[name="feeling_custom"]').value.trim()){show(6,"يرجى كتابة الإحساس الآخر");return false;}return true;
case 7:if(!document.querySelector('input[name="old_logo"]:checked')){show(7,"يرجى اختيار الإجابة");return false;}return true;
default:return true;
}}

document.getElementById('next-btn').onclick=()=>{if(validateStep(currentStep)&&currentStep<totalSteps){currentStep++;updateUI();}};
document.getElementById('prev-btn').onclick=()=>{if(currentStep>1){currentStep--;updateUI();}};

document.querySelectorAll('.option-card').forEach(card=>{
card.onclick=function(){
const r=this.querySelector('input[type="radio"]');
if(!r)return;
document.querySelectorAll(`input[name="${r.name}"]`).forEach(i=>i.closest('.option-card').classList.remove('selected'));
r.checked=true;this.classList.add('selected');
if(r.name==='work_type')document.getElementById('work-custom').style.display=r.value==='شيء آخر'?'block':'none';
if(r.name==='colors')document.getElementById('color-custom').style.display=r.value==='شيء آخر'?'block':'none';
if(r.name==='logo_type')document.getElementById('logo-type-custom').style.display=r.value==='شيء آخر'?'block':'none';
if(r.name==='feeling')document.getElementById('feeling-custom').style.display=r.value==='شيء آخر'?'block':'none';
if(r.name==='old_logo')document.getElementById('logo-details').style.display=r.value==='نعم'?'block':'none';
}};
});

const fileUpload=document.getElementById('file-upload');
const fileInput=document.getElementById('file-input');
const fileName=document.getElementById('file-name');
fileUpload.onclick=()=>fileInput.click();
fileInput.onchange=()=>{fileName.textContent=fileInput.files.length>0?fileInput.files[0].name:'لم يتم رفع أي ملف بعد';};

async function fileToBase64(f){return new Promise((res,rej)=>{const r=new FileReader();r.onload=()=>res(r.result.split(',')[1]);r.onerror=rej;r.readAsDataURL(f);});}

document.getElementById('clientForm').addEventListener('submit',async e=>{
e.preventDefault();if(!validateStep(totalSteps))return;
const data={timestamp:new Date().toLocaleString('ar-SA')};
function val(name,custom){const el=document.querySelector(`input[name="${name}"]:checked`);if(!el)return'';if(el.value==='شيء آخر'){return document.querySelector(`input[name="${custom}"]`)?.value.trim()||'';}return el.value;}
data.project_name=document.querySelector('input[name="project_name"]').value.trim();
data.work_type=val('work_type','work_custom');
data.logo_style=val('logo_style','');
data.colors=val('colors','color_custom');
data.logo_type=val('logo_type','logo_type_custom');
data.feeling=val('feeling','feeling_custom');
data.old_logo=val('old_logo','');
data.logo_details=document.querySelector('textarea[name="logo_details"]')?.value.trim()||'';

const fd=new FormData();for(let k in data)fd.append(k,data[k]);
if(fileInput.files.length>0){const f=fileInput.files[0];fd.append('file_name',f.name);fd.append('file_type',f.type);fd.append('file_base64',await fileToBase64(f));}

document.querySelector('form').style.display='none';
document.getElementById('loading').style.display='block';
try{
const r=await fetch(scriptURL,{method:'POST',body:fd});
const j=await r.json();
document.getElementById('loading').style.display='none';
if(j.result==='success'){document.getElementById('thankyou-message').style.display='block';}
else throw new Error(j.message);
}catch(err){
alert('حدث خطأ أثناء الإرسال: '+err.message);
document.querySelector('form').style.display='block';
document.getElementById('loading').style.display='none';
}
});
updateUI();
</script>
</body>
</html>
